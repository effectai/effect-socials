(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1095:function(t,e,n){"use strict";n.r(e);n(159),n(484),n(101),n(218),n(54),n(102),n(964),n(126),n(157),n(156),n(154),n(472);var r=n(968),c=(n(123),n(28)),o=n(45),l=n(1078),d=n(127);function v(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,c=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw c}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function _(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function h(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m=n(1072),w={components:{Tweet:l.Tweet,Timeline:l.Timeline},data:function(){return{loading:!0,effectsdk:null,id:parseInt(this.$route.params.id),tasks:null,results:null,timer:null,batch:null,batchIpfs:null,campaign:null,transaction:null}},mounted:function(){var t=this;this.transaction=this.transactionByBatchId(this.id),this.getBatch(),this.getResults(),this.timer=setInterval((function(){t.getResults()}),3e4)},computed:h(h({},Object(d.c)({transactionByBatchId:"transaction/transactionByBatchId"})),{},{batchPercentageDone:function(){return this.batch?Math.round(this.batch.tasks_done/(this.batch.num_tasks*this.batch.repetitions)*100):0}}),methods:{getBatch:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$effect.force.getBatchById(t.id);case 3:return t.batch=e.sent,e.next=6,t.$effect.force.getIpfsContent(t.batch.content.field_1);case 6:return t.batchIpfs=e.sent,e.next=9,t.$effect.force.getCampaign(t.batch.campaign_id);case 9:t.campaign=e.sent,t.loading=!1;case 11:case"end":return e.stop()}}),e)})))()},getResults:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,c,o,l,d,f,_,h,m,w,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,t.results&&(n=t.results.length),e.next=4,t.$effect.force.getSubmissionsOfBatch(t.id);case 4:t.results=e.sent,c=Object(r.a)(new Set(t.results.map((function(t){return t.account_id})))),o=[],l=v(c),e.prev=8,l.s();case 10:if((d=l.n()).done){e.next=18;break}return f=d.value,e.next=14,t.$effect.force.getAssignedQualifications(null,100,!1,f);case 14:_=e.sent,o.push.apply(o,Object(r.a)(_));case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),l.e(e.t0);case 23:return e.prev=23,l.f(),e.finish(23);case 26:37,h=o.filter((function(t){return 37===t.quali_id})),m=v(t.results);try{for(k=function(){var t=w.value,e=h.find((function(e){return e.account_id===t.account_id}));e&&(t.account={},t.account.quali_value=e.value.replace(/"/g,""))},m.s();!(w=m.n()).done;)k()}catch(t){m.e(t)}finally{m.f()}t.results.length!==n&&(console.log("results changed"),t.getBatch()),t.batch.tasks_done===t.batch.num_tasks*t.batch.repetitions&&clearInterval(t.timer);case 32:case"end":return e.stop()}}),e,null,[[8,20,23,26]])})))()},downloadTaskResults:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.results.map(function(){var t=Object(c.a)(regeneratorRuntime.mark((function t(e){var sub,n,r,c,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for((sub={}).data=JSON.parse(e.data),n=0,r=Object.keys(sub.data);n<r.length;n++)c=r[n],e[c]=sub.data[c];return delete e.content,delete e.batch_id,delete e.id,delete e.leaf_hash,delete e.paid,o={link_id:null,account_id:null},e=Object.assign(o,e),t.abrupt("return",e);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:return n=e.sent,e.next=6,m(n,(function(e,n){if(e)return console.error(e);var r="task_results_".concat(t.id,".csv"),c=new Blob([n],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(c,r);else{var link=document.createElement("a");if(void 0!==link.download){var o=URL.createObjectURL(c);link.setAttribute("href",o),link.setAttribute("download",r),link.style.visibility="hidden",document.body.appendChild(link),link.click(),document.body.removeChild(link)}}}));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}},beforeDestroy:function(){clearInterval(this.timer)}},k=n(34),component=Object(k.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"section pt-6"},[n("div",{staticClass:"container is-max-desktop"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("h2",{staticClass:"title"},[t._v("Order")]),t._v(" "),n("nav",{staticClass:"breadcrumb",attrs:{"aria-label":"breadcrumbs"}},[n("ul",[n("li",[n("nuxt-link",{attrs:{to:"/"}},[t._v("Home")])],1),t._v(" "),n("li",[n("nuxt-link",{attrs:{to:"/batch"}},[t._v("Dashboard")])],1),t._v(" "),n("li",{staticClass:"is-active"},[n("nuxt-link",{attrs:{to:"#","aria-current":"page"}},[t._v("Order")])],1)])]),t._v(" "),t.loading?n("div",{staticClass:"loading-text"},[t._v("\n          Loading\n        ")]):n("div",[t.batch&&t.campaign?n("div",[n("br"),t._v(" "),n("div",{staticClass:"box media"},[n("div",{staticClass:"media-content"},[n("div",{staticClass:"content"},[n("p",{staticClass:"subtitle"},[n("a",{attrs:{href:"https://app.effect.network/campaigns/"+t.batch.campaign_id,target:"_blank",rel:"noopener noreferrer"}},[n("span",{staticClass:"icon-text"},[n("span",[t._v(t._s(t.campaign.info.title))]),t._v(" "),n("span",[n("font-awesome-icon",{staticClass:"mx-1 icon is-small",attrs:{icon:"fa-solid fa-arrow-up-right-from-square"}})],1)])])]),t._v(" "),n("hr"),t._v(" "),n("p",{staticClass:"subtitle has-text-black"},[t._v("Order")]),t._v(" "),n("div",{staticClass:"px-6"},[n("p",[t._v("Status: "+t._s(t.batchPercentageDone)+"%")]),t._v(" "),n("progress",{staticClass:"progress is-info",domProps:{value:t.batchPercentageDone}})]),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"px-6 is-centered table-container"},[n("table",{staticClass:"table is-narrow is-centered px-6"},[n("thead"),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("Order-ID")]),t._v(" "),n("td",[n("a",{attrs:{href:"https://app.effect.network/campaigns/"+t.batch.campaign_id+"/"+t.id,target:"_blank",rel:"noopener noreferrer"}},[n("span",{staticClass:"icon-text"},[n("span",[t._v(t._s(t.id))]),t._v(" "),n("span",[n("font-awesome-icon",{staticClass:"mx-1 icon is-small",attrs:{icon:"fa-solid fa-arrow-up-right-from-square"}})],1)])])])]),t._v(" "),n("tr",[n("td",[t._v("BlockExplorer")]),t._v(" "),n("td",[n("a",{attrs:{href:"https://bloks.io/transaction/"+t.transaction.eos.transaction.transaction_id,target:"_blank",rel:"noopener noreferrer"}},[n("span",{staticClass:"icon-text"},[n("span",[t._v("BlockExplorer")]),t._v(" "),n("span",[n("font-awesome-icon",{staticClass:"mx-1 icon is-small",attrs:{icon:"fa-solid fa-arrow-up-right-from-square"}})],1)])])])]),t._v(" "),n("tr",[n("td",[t._v("Tasks")]),t._v(" "),n("td",[t._v(t._s(t.batch.num_tasks)+" ×")])]),t._v(" "),n("tr",[n("td",[t._v("Amount")]),t._v(" "),n("td",[t._v(t._s(t.batch.repetitions)+" ×")])]),t._v(" "),n("tr",[n("td",[t._v("Cost per Task")]),t._v(" "),n("td",[n("strong",[t._v(t._s(t.campaign.info.reward)+" EFX")])])])]),t._v(" "),n("tfoot",[n("tr",[n("td",[t._v("Total Cost")]),t._v(" "),n("td",[n("strong",[t._v(t._s(t.campaign.info.reward*t.batch.num_tasks*t.batch.repetitions)+" EFX")])])]),t._v(" "),n("tr",{staticClass:"is-size-7"},[n("td",[n("span",[t._v("Network Fee")]),t._v(" "),n("span",{staticClass:"icon is-small",attrs:{"data-tooltip":"10% of the transaction is sent to the Effect Network DAO. Already included."}},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-circle-info"}})],1)]),t._v(" "),n("td",[t._v(t._s(t.campaign.info.reward*t.batch.num_tasks*t.batch.repetitions*.1)+" "),n("i",[t._v("EFX")])])])])])]),t._v(" "),n("hr"),t._v(" "),n("p",{staticClass:"subtitle has-text-black"},[t._v("Links")]),t._v(" "),n("div",{staticClass:"px-6 mx-auto is-centered"},[14===t.campaign.id||16===t.campaign.id||17===t.campaign.id?n("vsa-list",t._l(t.batchIpfs.tasks,(function(e,r){return n("vsa-item",{key:r},[n("vsa-heading",[n("span",{staticClass:"icon-text"},[n("span",[t._v(t._s(e.tweet))])])]),t._v(" "),e.tweet?n("vsa-content",{staticClass:"mx-auto"},[n("Tweet",{staticClass:"mx-auto",attrs:{id:e.tweet.split("/")[1],options:{cards:"hidden"}}},[n("div",{staticClass:"mx-auto is-centered"},[n("progress",{staticClass:"progress mx-auto is-info"})])])],1):t._e()],1)})),1):15===t.campaign.id?n("vsa-list",t._l(t.batchIpfs.tasks,(function(e,r){return n("vsa-item",{key:r},[n("vsa-heading",[n("span",{staticClass:"icon-text"},[n("span",[t._v(t._s(e.twitter_handle))])])]),t._v(" "),n("vsa-content",{staticClass:"mx-auto"},[n("Timeline",{staticClass:"mx-auto",attrs:{id:e.twitter_handle,sourceType:"profile",options:{tweetLimit:"1"}}},[n("progress",{staticClass:"progress mx-auto is-info"})])],1)],1)})),1):n("vsa-list",t._l(t.batchIpfs.tasks,(function(e,r){return n("vsa-item",{key:r},[n("vsa-heading",[n("span",{staticClass:"icon-text"},[n("span",[t._v(t._s(r))])])]),t._v(" "),n("vsa-content",[t._v("\n                          "+t._s(e)+"\n                        ")])],1)})),1)],1),t._v(" "),n("hr"),t._v(" "),n("p",{staticClass:"subtitle has-text-black"},[t._v("Results ("+t._s(t.batch.tasks_done)+"/"+t._s(t.batch.num_tasks*t.batch.repetitions)+")")]),t._v(" "),t.results&&t.results.length>0?n("div",{staticClass:"table-container px-6"},[n("table",{staticClass:"table",staticStyle:{width:"100%"}},[t._m(0),t._v(" "),n("tbody",t._l(t.results,(function(e){return n("tr",{key:e.id},[n("td",[t._v(t._s(e.id))]),t._v(" "),e.data&&14===t.batch.campaign_id?n("td",[n("a",{attrs:{href:"https://twitter.com/"+e.data.split("/")[0].slice(1)+"/status/"+e.data.split("/")[1].slice(0,-1),target:"_blank",rel:"noopener noreferrer"}},[t._v("\n                              "+t._s(e.data.split("/")[1].slice(0,-1))+"\n                            ")])]):n("td",[t._v("Loading")]),t._v(" "),e.account&&e.account.address?n("td",[n("a",{attrs:{href:"https://app.effect.network/profile/"+e.account.address[1],target:"_blank",rel:"noopener noreferrer"}},[n("span",{staticClass:"icon-text"},[n("span",[t._v(t._s(e.account_id))]),t._v(" "),n("span",[n("font-awesome-icon",{staticClass:"mx-1 icon is-small",attrs:{icon:"fa-solid fa-arrow-up-right-from-square"}})],1)])])]):n("td",[t._v(t._s(e.account_id))]),t._v(" "),e.account&&e.account.quali_value?n("td",[t._v(t._s(e.account.quali_value))]):n("td",[t._v("Loading")]),t._v(" "),n("td",[t._v(t._s(e.submitted_on))])])})),0)]),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"buttons is-centered"},[n("button",{staticClass:"button is-primary mx-auto is-centered",on:{click:function(e){return e.preventDefault(),t.downloadTaskResults()}}},[t._v("\n                        Download results\n                      ")])])]):n("div",{staticClass:"has-text-centered"},[n("br"),t._v(" "),t._m(1)])])])])]):n("div",[n("p",[t._v("No batch found")])])])])])])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("ID")]),t._v(" "),n("th",[t._v("Tweet")]),t._v(" "),n("th",[t._v("Worker")]),t._v(" "),n("th",[t._v("Quali-Value")]),t._v(" "),n("th",[t._v("Submitted on")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n                      No results yet.\n                      "),e("br"),this._v("\n                      Please wait while someone starts working on your order.\n                    ")])}],!1,null,"5a591d9e",null);e.default=component.exports}}]);